\addtocontents{toc}{\protect\newpage}
\chapter{Conclusion and Further Work}
\label{chap:Conclusion}
	%\note
	%{
	%	Well that was a load of nonsense wasn't it? Let's go to the pub!
	%}

	In this	thesis we have investigated the problem of applying timbral control using harmonic excitation systems. The
	primary aim was to identify techniques by which harmonic excitation can be used to provide intuitive control over
	the perceived properties of audio signals. These can then be used to aid novice users in carrying out common audio
	engineering tasks. Harmonic excitation techniques are useful in these applications as they allow for a greater
	number of spectral features to be manipulated than LTI systems; they can be used to introduce new frequency
	content to a signal. A disadvantage is that they are typically nonlinear system and their effects are highly
	dependant on the content of the input signal. A key problem to solve for this work was the development of harmonic
	excitation systems which produce similar effects over a wide range of input signals.

	The approach taken in this thesis can be divided into three main stages. Firstly, subjective data about the
	manipulation of timbre in music production was gathered. Various analysis techniques were then applied to this data
	to determine how language is used to describe timbral transformations and the low level audio features which
	correlate with these descriptions. Secondly, a number of nonlinear and time variant signal processing algorithms
	were evaluated against how well their effects on the features of a signal can be controlled. The results from this
	analysis were used to inform the design of harmonic excitation systems which provide monotonic control over a
	particular low level audio feature. Lastly, these systems were specialised to complete common audio processing
	tasks: reconstructing the spectrum of degraded audio signals and applying creative timbral manipulations using
	semantically labelled parameters. The performance of the resulting systems was evaluated with a series of perceptual
	listening tests. Sections \ref{sec:Conclusion-Descriptors} to \ref{sec:Conclusion-TimbralControl} summarise the main
	findings from each of these stages.

\section{Timbral Descriptors}
\label{sec:Conclusion-Descriptors}
	Analysis of 304 applications of a distortion effect and 1483 applications of an equaliser effect identified 17 terms
	which are commonly used to describe timbre or timbral transformations. The terms crunchy, fuzzy, creamy, raspy and
	smooth were used only to describe applications of distortion while clear, airy, thin, full, boomy, boxy, tinny, deep
	and muddy were used only to describe equalisation. Three terms (warm, bright and harsh) were used to describe
	transformations applied by both of the effects. A new metric to measure the degree to which people agree on the use
	of these descriptors was used to show that the most consistently used terms are warm bright and crunchy. Clustering
	of the terms based on the audio features of the signals they describe lead to four distinct timbral groups:
	warmth, brightness, crunchiness and muddiness. 

	Through construction and analysis of timbre spaces, the audio features which contribute to the perception of a
	particular descriptor were identified. Spectral centroid was found to be a major factor in differentiating between
	the different timbral groups. Warmth describing transforms in which the spectral centroid is decreased and
	brightness those in which it is increased. Muddiness is also described by a decrease in spectral centroid but with a
	further stipulation that the majority of the energy in the output is in specific low frequency bands. Crunchiness
	was found to be better characterised by an increase in spectral irregularity producing a flatter but more irregular
	spectrum. A distinction can be made between terms which describe a transform (change in audio features) and those
	which describe the properties of a signal. Warmth and brightness are mostly associated the description of feature
	changes, muddiness with the properties of the output signal and crunchiness with both. Within the timbral groups,
	changes in timbre can be described using more precise descriptors. For example harsh (part of the brightness group)
	describes signals with a higher proportion of high frequency energy than bright, despite both describing transforms
	which increase the spectral centroid.

\section{Control of Audio Features with Harmonic Exciters}
\label{sec:Conclusion-FeatureConrol}
	To determine the suitability of harmonic excitation algorithms to timbral control their behaviour was assessed in
	the areas of: complexity, homogeneity, spectral characteristics and temporal characteristics. It was shown that the
	effects of a harmonic excitation system become more easily predictable if the input is sinusoidal, in most cases
	producing a set of harmonics of the input frequency. Monophonic tonal signals can be made sinusoidal by tracking
	their $f_{0}$ and filtering out all higher frequencies to take advantage of this fact. Other techniques by which the
	performance of particular algorithms can be improved were also discussed, such as modelling static nonlinearities as
	polynomials to restrict the frequency range of their output.
	
	Use cases for each of the algorithms evaluated were suggested, and the most useful for timbral control noted.
	Broadly, the algorithms can be divided into two groups: those which generate a band of new energy in the spectrum
	and those which can be used to generate individual harmonics. In situations where a large band of energy needs to be
	added to the spectrum, without precise control over its content, static nonlinearities prove to be the most
	efficient choice. One can either choose a homogeneous nonlinearity (such as a full wave rectifier) or apply
	additional steps to make the system homogeneous (such as a gain stage either side). Where finer control of the
	spectrum is desired, individual harmonics can be generated and summed together. This gives better control at the
	expense of greater computational complexity. The IAP technique was shown to have the best performance in this type
	of system, exhibiting positive homogeneity and also being shown to produce the most natural sounding harmonics in
	subjective listening tests. The performance of the algorithms in these tests was highly negatively correlated with
	the variability of the amplitude ratio between the harmonics and $f_{0}$ in the input signal. This shows that the
	reconstruction of harmonics from the $f_{0}$ removes spectral and temporal information crucial to the perception of
	timbre.

	It was shown that using these algorithms, systems can be constructed which provide monotonic control over the
	spectral moments, irregularity, flatness, slope, tristimulus, odd to even harmonic ratio and inharmonicity of a set
	of test signal. While this control is not always linear, its monotonic nature allows for more intuitive control as
	the feature will always move in the same direction for a given direction in change of parameter value. As the
	systems rely on the $f_{0}$ of the input signal being isolated, the control of certain feature in signals without a
	strong $f_{0}$ is lost. 

\section{Timbral Control with Harmonic Exciters}
\label{sec:Conclusion-TimbralControl}
	To create effects which provide intuitive timbral control the findings discussed in the previous to sections were
	combined. The systems developed for controlling features were specialised to produce the feature manipulations which
	correspond to particular timbral descriptions. Two effects were developed in this manner: one moving audio signals
	between warmth and brightness in the timbre space and the other between crunchiness and brightness. Each of these
	effects was evaluated both objectively, against semantic timbral data, and subjectively in a series of listening
	tests.

	The warmth / brightness effect manipulates the spectral centroid of a signal by adjusting the relative levels of two
	bands in the spectrum: a low band generated by low pass filtering and a high band generated by application of full
	wave rectification. To ensure the centroid can be moved in both directions the, low and high frequency bands are low
	and high pass filtered at the input spectral centroid respectively. It is shown that this system can be used to
	apply transforms similar to those labelled warm, bright and harsh in the SAFE dataset to a selection of monophonic
	input signals. However, the resulting signals were not so similar to those produced by the relevant transforms in
	the SAFE dataset. 

	The subjective performance of the effect was evaluated by asking test participants to describe its effects on
	various input signals. When the system was emulating transforms labelled as bright and harsh in the SAFE dataset,
	participants chose descriptors in the relevant timbral group 74\% and 80\% of the time respectively. While for
	transforms which should have been labeled as warm the descriptors chosen were only in the relevant group 54\% of the
	time. From this, it is concluded that increasing the spectral centroid through the application of nonlinear
	distortion is an effective way to evoke the perception of brightness or harshness in a signal. Conversely, reducing
	the spectral centroid through low pass filtering is not sufficient to introduce warmth to a signal. It is considered
	that the perception of warmth may rely on the spectral properties of the output as well as the way in which the
	spectral centroid is manipulated.

	The brightness / crunchiness effect independently controls the levels of the first six harmonics in the output in
	order to adjust its spectral irregularity and higher order spectral moments. Computational complexity is reduced by
	generating higher order harmonics through full wave rectification. As with the warmth / harshness effect it is shown
	that this effect performed well when emulating transforms labelled as bright and harsh in the SAFE dataset. However,
	when emulating crunchiness the transforms were only similar in terms of the features of the output signals. This is
	thought to be due to the low order filtering used when generating the individual harmonics. Higher order filtering
	would allow for better isolated harmonics providing more accurate control over the spectral properties.

	Subjectively the brightness / crunchiness effect performed similarly to the warmth / brightness effect. Participants
	gave a descriptor in the relevant timbral group 72\% and 90\% of the time for transforms which were intended to be
	bright and harsh respectively. This reinforces the concept that addition of high frequency content using a nonlinear
	system evokes the perception of timbres related to brightness and harshness. When applying transforms intended to
	introduce crunchiness however, the effect performed less well; participants only choosing descriptors from the
	relevant group 51\% of the time. It is concluded that this is due to the poor control over the finer spectral detail
	due to the order of the filters used.

\section{Critique}
\label{sec:Conclusion-Critique}
	\note
	{
		Critical review? (what do we cover well and what do we miss out, pros and cons)

		Say why it's good before slagging it off.

		Set up things for further work.

		\begin{itemize}
			\item Only works on tonal features.
			\item Limited sample size for all descriptors other than warm and bright.
			\item Vocabulary elicited from trained music producers who may have learned them, thereby not being
				useful for untrained people.
			\item Control of features is not independent. (monotonic but not independent)
			\item No information on extent to which a term applies to a transform / signal. The differences
				found between groups could be much smaller than in reality. No ability to rank signals /
				transforms in terms of a descriptor.
		\end{itemize}
	}

\section{Further Work}
\label{sec:Conclusion-FurtherWork}
	\note
	{
		\begin{itemize}
			\item Extend to other descriptors.
			\item Run more extensive experiments to highlight the differences between the terms within the
				timbral groups.
			\item Potential applications in audio restoration.
			\item Alter SAFE to elicit the degree to which a term applies.
			\item Apply to other classes of effects.
		\end{itemize}
	}
